<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>學習地圖 by 桑格設計書店</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width">
    <script type="text/javascript">
      var projectId = 'quantum-ally-425';
      var clientId = '391877613342-8gcouc7ae00tol7janmdvne90l2oavb7.apps.googleusercontent.com';
      var apiKey = 'AIzaSyDmffFg_fSWYyzgwWKFFkDLv02JFKSUTbU';
      var scopes = 'https://www.googleapis.com/auth/analytics.readonly';
      var access_token;

      function loadLib(){
        gapi.client.setApiKey(apiKey);
        gapi.auth.authorize({
          client_id: clientId,
          scope: scopes,
          immediate: false
        }, function(authResult) {
          if (authResult && !authResult.error) {
            console.log('is OK');
            access_token = authResult.access_token;
            console.log(authResult.access_token);
            console.log("Auth was successful!");
          } else {
            console.log("Auth was not successful");
          }
        });

        gapi.client.load('analytics', 'v3', makeApiCall);

      };
      var apiQuery;
      function makeApiCall() {
        apiQuery = gapi.client.analytics.data.ga.get({
          'ids': 'ga:76589940',
          'start-date': '2013-11-26',
          'end-date': '2013-12-10',
          'metrics': 'ga:pageviews',
          'dimensions': 'ga:pageTitle',
          // 'sort': '-ga:visits,ga:source',
          // 'filters': 'ga:medium==organic',
          'access_token': access_token,
          'max-results': 25
        });
        apiQuery.execute(handleCoreReportingResults);
      }

      function handleCoreReportingResults(results) {
        if (!results.error) {
          console.log(results);
        } else {
          alert('There was an error: ' + results.message);
        }
      }
    </script>
    <script src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="https://apis.google.com/js/client.js?onload=loadLib"></script>
  </head>
  <body>
    Sungood_book_value
  </body>
</html>